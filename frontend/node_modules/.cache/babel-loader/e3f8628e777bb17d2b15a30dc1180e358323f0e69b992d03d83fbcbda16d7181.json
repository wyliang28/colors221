{"ast":null,"code":"var _jsxFileName = \"/Users/hf/PycharmProjects/color221/frontend/src/Orders.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Orders() {\n  _s();\n  const [orders, setOrders] = useState([]);\n  const [packages, setPackages] = useState([]);\n  const [selectedPkg, setSelectedPkg] = useState('');\n  useEffect(() => {\n    axios.get('http://localhost:5000/orders').then(res => setOrders(res.data));\n    axios.get('http://localhost:5000/packages').then(res => setPackages(res.data));\n  }, []);\n  const handleSell = async () => {\n    try {\n      await axios.post('http://localhost:5000/sell', {\n        package_id: selectedPkg\n      });\n      alert('销售成功！');\n      axios.get('http://localhost:5000/orders').then(res => setOrders(res.data));\n    } catch (err) {\n      var _err$response, _err$response$data;\n      alert(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || '销售失败');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\u8BA2\\u5355\\u7BA1\\u7406\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"select\", {\n        className: \"form-control mb-2\",\n        value: selectedPkg,\n        onChange: e => setSelectedPkg(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"\\u9009\\u62E9\\u8981\\u9500\\u552E\\u7684\\u5957\\u9910\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 36,\n          columnNumber: 11\n        }, this), packages.map(pkg => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: pkg.id,\n          children: [pkg.name, \" (\\u6263\\u51CF\", pkg.deduction, \"g)\"]\n        }, pkg.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 38,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 31,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSell,\n        className: \"btn btn-warning\",\n        disabled: !selectedPkg,\n        children: \"\\u6267\\u884C\\u9500\\u552E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      className: \"table\",\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"\\u5957\\u9910\\u540D\\u79F0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"\\u5305\\u542B\\u989C\\u8272\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 56,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"\\u9500\\u552E\\u65F6\\u95F4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 57,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: orders.map(order => /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            children: order.package_name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: order.colors.split(',').map(id => {\n              var _packages$find;\n              return ((_packages$find = packages.find(p => p.colors === id)) === null || _packages$find === void 0 ? void 0 : _packages$find.colors) || id;\n            }).join(', ')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n            children: new Date(order.date).toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 15\n          }, this)]\n        }, order.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 27,\n    columnNumber: 5\n  }, this);\n}\n_s(Orders, \"8FOvdq2NrB4s7K2GADsK9gBJ4hU=\");\n_c = Orders;\nvar _c;\n$RefreshReg$(_c, \"Orders\");","map":{"version":3,"names":["React","useState","useEffect","axios","jsxDEV","_jsxDEV","Orders","_s","orders","setOrders","packages","setPackages","selectedPkg","setSelectedPkg","get","then","res","data","handleSell","post","package_id","alert","err","_err$response","_err$response$data","response","error","children","fileName","_jsxFileName","lineNumber","columnNumber","className","value","onChange","e","target","map","pkg","id","name","deduction","onClick","disabled","order","package_name","colors","split","_packages$find","find","p","join","Date","date","toLocaleString","_c","$RefreshReg$"],"sources":["/Users/hf/PycharmProjects/color221/frontend/src/Orders.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nfunction Orders() {\n  const [orders, setOrders] = useState([]);\n  const [packages, setPackages] = useState([]);\n  const [selectedPkg, setSelectedPkg] = useState('');\n\n  useEffect(() => {\n    axios.get('http://localhost:5000/orders').then(res => setOrders(res.data));\n    axios.get('http://localhost:5000/packages').then(res => setPackages(res.data));\n  }, []);\n\n  const handleSell = async () => {\n    try {\n      await axios.post('http://localhost:5000/sell', {\n        package_id: selectedPkg\n      });\n      alert('销售成功！');\n      axios.get('http://localhost:5000/orders').then(res => setOrders(res.data));\n    } catch (err) {\n      alert(err.response?.data?.error || '销售失败');\n    }\n  };\n\n  return (\n    <div>\n      <h2>订单管理</h2>\n\n      <div className=\"mb-4\">\n        <select\n          className=\"form-control mb-2\"\n          value={selectedPkg}\n          onChange={e => setSelectedPkg(e.target.value)}\n        >\n          <option value=\"\">选择要销售的套餐</option>\n          {packages.map(pkg => (\n            <option key={pkg.id} value={pkg.id}>\n              {pkg.name} (扣减{pkg.deduction}g)\n            </option>\n          ))}\n        </select>\n        <button\n          onClick={handleSell}\n          className=\"btn btn-warning\"\n          disabled={!selectedPkg}\n        >\n          执行销售\n        </button>\n      </div>\n\n      <table className=\"table\">\n        <thead>\n          <tr>\n            <th>套餐名称</th>\n            <th>包含颜色</th>\n            <th>销售时间</th>\n          </tr>\n        </thead>\n        <tbody>\n          {orders.map(order => (\n            <tr key={order.id}>\n              <td>{order.package_name}</td>\n              <td>\n                {order.colors.split(',').map(id =>\n                  packages.find(p => p.colors === id)?.colors || id\n                ).join(', ')}\n              </td>\n              <td>{new Date(order.date).toLocaleString()}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}